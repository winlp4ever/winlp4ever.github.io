<!DOCTYPE html>
<html>
    <head>
        <!-- basic set-ups -->
        <meta charset="utf8">
        <meta name='author' content="me">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- css style files (local  and fontawesome and devicon -->
        <link rel='stylesheet' href='css/style.css'>
        <link rel='stylesheet' href='css/app.css'>
        <link rel='stylesheet' href='css/navi.css'>
        <link rel='stylesheet' href='css/outline.css'>

        <link rel="stylesheet" href="https://cdn.rawgit.com/konpa/devicon/df6431e323547add1b4cf45992913f15286456d3/devicon.min.css">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
        
        <!-- prism.css to enable code snippets with syntax highlighting on website -->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/tomorrow.min.css">
        

        <!-- vega-lite to enable data visualization on website -->
        <script src="https://cdn.jsdelivr.net/npm/vega@5.3.5/build/vega.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@3.2.1/build/vega-lite.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@4.0.0/build/vega-embed.js"></script>

        <style media="screen">
            /* Add space between Vega-Embed links  */
            .vega-actions a {
                margin-right: 5px;
            }
        </style>
    </head>
    <body>
        <!-- links bar (where to share contacts) -->
        <button id='menuclick'><i class="fa fa-hashtag"></i></button>
        <div id='links'>
            <span id='ruler'></span>
            <span><a href='https://github.com/winlp4ever' target='_blank'><i class="fab fa-github"></i></a></span>
            <span><a href='https://www.facebook.com/letringuyenquang' target='_blank'><i class="fab fa-facebook"></i></a></span>
            <span><a href='https://www.linkedin.com/in/ha-quang-le/' target='_blank'><i class="fab fa-linkedin"></i></a></span>
            <div id='annotate'></div>
        </div>
        <!-- main menu - navigator -->
        <div id='navi'>
            
            
            <span id='posts'>Posts</span>
            <div class='drleft'><i class="fa fa-angle-down fa-fw"></i></div>
            <span id='coding'>Coding</span>
            <span id='dl'>DLearning</span>

            <div class='slsh'></div>
            <span id='home'>Home</span>
            <span><a href='//winlp4ever.github.io/aboutme/.' target='_blank'>My CV</a></span>
        </div>

        <div id='outline'>
            <span><i class="fa fa-hashtag"></i>Content</span>
        </div>

        <!-- mainbody, where to write posts -->
        <div id='mainbody'>
            <!-- a post, div class post -->
            <div class='post home coding' id='about-me'>
                <h1 class='posttitle'>GMM clustering visualization</h1>
                <p>
                    When it comes to clustering, <i>Gaussian Mixture model</i> is often amongst our first choices as method. Let's find out how to visualize it in a 
                    best way:
                </p>
                <p>First, we build up an artificial data, in real situations, of course it is provided:</p>
                <!-- code snippets always enclosed in pre code flags -->
                <pre><code class="python">
                        n_samples = 1000
                        mus = [(1., 1.), (5., 2.), (3., 4.)]
                        covs = [(0.1, 0.5), (0.5, 0.6), (0.2, 0.4)]
                        alphas = [0.2, 0.5, 0.3]
                        gauss = np.random.choice(3, p=alphas, size=n_samples)
                        gauss = np.eye(3)[gaussians].astype('int')
                        
                        U = np.stack([np.random.multivariate_normal(mus[i], np.diag(covs[i]), size=n_samples) 
                                             for i in range(3)], axis=1)
                        X_train = np.zeros(shape=(n_samples, 2))
                        X_train[:, 0] = np.einsum('ij, ij->i', gauss, U[:,:, 0])
                        X_train[:, 1] = np.einsum('ij, ij->i', gauss, U[:,:, 1])
                        print(X_train.shape)
                </code></pre>
                <p>Now let define a GMM model, remember to import <code>GaussianMixture</code> model from <code>sklearn</code> already:</p>

                <pre><code class='python'>
                        gmm = GaussianMixture(n_components=3, init_params='kmeans')
                        Y = gmm.fit_predict(X_train) # model is train and output the final predictions on data
                </code></pre>

                <p>With the help of <code>contour</code> functions in <code>matplotlib</code>, we will be able to produce something pretty. The idea is 
                quite simple, we construct a grid, compute all grid nodes' values with our model, then draw contours.</p>
                <pre><code class='python'>
                        gridx, gridy = np.linspace(0, 8, num=100), np.linspace(-1, 7, num=100)# on range of points
                        x, y = np.meshgrid(gridx, gridy)
                        xy = np.array([x.ravel(), y.ravel()]).T
                        z = -gmm.score_samples(xy)
                        z = z.reshape(x.shape)
                </code></pre>
                <p>The final plotting code:</p>
                <pre><code class='python'>
                        plt.figure(figsize=(15, 10))

                        mapcolor = 'Spectral'
                        contours = plt.contour(x, y, z, norm=LogNorm(vmin=1.0, vmax=1000.0),
                                         levels=np.logspace(0, 3, 20), cmap=mapcolor, alpha=1)
                        plt.clabel(contours, inline=True, fontsize=12)
                        plt.contourf(x, y, z, norm=LogNorm(vmin=1.0, vmax=1000.0),
                                         levels=np.logspace(0, 3, 20), cmap=mapcolor, alpha=0.3)
                        plt.imshow(z, extent=[0, 8, -1, 7], origin='lower',
                                   cmap=mapcolor, alpha=0.3)
                        plt.colorbar()
                        plt.scatter(X_train[:100, 0], X_train[:100, 1], c=Y[:100], s=200, 
                                    cmap=mapcolor, alpha=0.5, linewidths=2, edgecolors='grey')
                        
                        font = {'family': 'Helvetica',
                                'color':  'black',
                                'weight': 'bold',
                                'size': 14,
                                }
                        plt.xlabel('xlabel', fontdict=font)
                        plt.ylabel('ylabel', fontdict=font)
                        plt.title('title', fontdict=font)
                        plt.show()
                </code></pre>

                <p>Here the result:</p>
                <img src='img/gmm.png' width='600'/>
            </div>
        
            <div class='post coding'>coding</div>
        </div>
        
        
        
        <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
        
        <script src="js/jquery-3.4.1.min.js"></script>
        <!-- my js -->
        <script src='js/main.js'></script>
        <script src='js/outline.js'></script>
        <script src='js/navi.js'></script>
        <script src='js/app.js'></script>
        
        <!-- code syntax highlighting-->
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        
    </body>
</html>